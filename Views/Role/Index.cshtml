@using Microsoft.AspNetCore.Identity
@model List<IdentityRole<int>>
@{
    ViewData["Title"] = "Roles";
}

<div class="flex justify-between items-center mb-3">
    @await Html.PartialAsync("Components/_Breadcrumbs")
    <div class="flex gap-2">
        @await Html.PartialAsync("Components/_HelpButton")
    </div>
</div>


@if (Model.Count > 0)
{
    <div class="overflow-x-auto">
        <table class="table striped">
            <thead>
                <th>#</th>
                <th>Title</th>
                <th>Permissions</th>
                <th>Users</th>
                <th>Actions</th>
            </thead>
            <tbody>
                @for (int i = 0; i < Model.Count; i++)
                {
                    <tr>
                        <td>@(i + 1)</td>
                        <td>@Model[i].Name</td>
                        <td><span class="badge primary">@ViewBag.Counts[@Model[i].Name]["permissions"]</span></td>
                        <td><span class="badge primary">@ViewBag.Counts[@Model[i].Name]["users"]</span></td>
                        <td>
                            <div class="flex gap-2">
                                @await Html.PartialAsync("Components/_UpdateButton", new UpdateButtonStruct("Role",
                                Model[i].Id))
                    </div>
                </td>
            </tr>
                        }
        </tbody>
    </table>
</div>
}
else
{
    <div class="alert">
        <i class="material-icons">warning</i>
        <p>No role defined yet!</p>
    </div>
}


@section Scripts {
    <script>
        window.setTimeout(() => {
            window.LaVie.funcs.injectModuleHelpData({
                title: "Roles",
                permissions: {
                    "Admin": {
                        "Create": false,
                        "Index": true,
                        "Update": true,
                        "Delete": false,
                    },
                    "Manager": false,
                    "Client": false
                },
                description: `Roels are assigned to users.
                            You cannot define nor delete roles themselves.
                            You can only change to which users they are
                            assigned or which permissions they include.`
            });
        }, 1000);
    </script>
}